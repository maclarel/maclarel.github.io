<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="Microsoft Strike CTF 2022 - Contoso Financial"><meta itemprop=description content="Premise Microsoft runs an internal CTF event every so often called Strike CTF. While we&rsquo;ve been asked not to share specifics around the challenges involved, I wanted to do a brief write-up, as it&rsquo;s certainly a unique one that catered to multiple skill levels and had an educational twist.
For anyone interested in doing some digging, the version Microsoft runs has also been seen in some B-Sides events (and other conferences) under the name ShadowBank."><meta itemprop=datePublished content="2022-04-19T00:00:00+00:00"><meta itemprop=dateModified content="2022-04-19T00:00:00+00:00"><meta itemprop=wordCount content="830"><meta itemprop=keywords content="ctf,"><meta property="og:title" content="Microsoft Strike CTF 2022 - Contoso Financial"><meta property="og:description" content="Premise Microsoft runs an internal CTF event every so often called Strike CTF. While we&rsquo;ve been asked not to share specifics around the challenges involved, I wanted to do a brief write-up, as it&rsquo;s certainly a unique one that catered to multiple skill levels and had an educational twist.
For anyone interested in doing some digging, the version Microsoft runs has also been seen in some B-Sides events (and other conferences) under the name ShadowBank."><meta property="og:type" content="article"><meta property="og:url" content="https://www.maclaren.dev/posts/2022-04/msft_contoso_strike/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-19T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Microsoft Strike CTF 2022 - Contoso Financial"><meta name=twitter:description content="Premise Microsoft runs an internal CTF event every so often called Strike CTF. While we&rsquo;ve been asked not to share specifics around the challenges involved, I wanted to do a brief write-up, as it&rsquo;s certainly a unique one that catered to multiple skill levels and had an educational twist.
For anyone interested in doing some digging, the version Microsoft runs has also been seen in some B-Sides events (and other conferences) under the name ShadowBank."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>Microsoft Strike CTF 2022 - Contoso Financial</title><link rel=stylesheet href=https://www.maclaren.dev/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://www.maclaren.dev>Logan MacLaren</a></div><nav class="site-nav hide-in-mobile"><a href=https://www.maclaren.dev/posts/>Blog</a></nav></div><div class="hdr-right hdr-icons"><button id=toc-btn class="hdr-btn desktop-only-ib" title="Table of Contents"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3" y2="6"/><line x1="3" y1="12" x2="3" y2="12"/><line x1="3" y1="18" x2="3" y2="18"/></svg></button><span class="hdr-social hide-in-mobile"><a href=https://www.linkedin.com/in/loganmaclaren/ target=_blank rel="noopener me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://github.com/maclarel target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://infosec.exchange/@gill3tt3 target=_blank rel="noopener me" title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="feather feather-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://www.maclaren.dev/posts/>Blog</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>Apr 19, 2022</span></div><h1>Microsoft Strike CTF 2022 - Contoso Financial</h1></header><div class=content><h1 id=premise>Premise<a href=#premise class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Microsoft runs an internal CTF event every so often called <code>Strike CTF</code>. While we&rsquo;ve been asked not to share specifics around the challenges involved, I wanted to do a brief write-up, as it&rsquo;s certainly a unique one that catered to multiple skill levels and had an educational twist.</p><p>For anyone interested in doing some digging, the version Microsoft runs has also been seen in some B-Sides events (and other conferences) under the name <code>ShadowBank</code>.</p><h1 id=event-format>Event format<a href=#event-format class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Unlike a more typical CTF, this event didn&rsquo;t just have a few &ldquo;flags&rdquo; to find - it had <em>fifty three</em> and an indeterminate amount of <em>bonus</em> flags.</p><p>Players were presented with a web application noted as being vulnerable (and oh boy was it&mldr;), and were instructed to find ways to identify and exploit many of the <a href=https://owasp.org/Top10/>OWASP Top 10</a>. Uniquely, this application would also <em>automatically detect and award</em> exploitation, which made it very cool for beginners who wanted to poke around and try things.</p><p>The 50 <em>main</em> challenges were focused around:</p><ul><li>Reflected XSS</li><li>SQL injection</li><li>Cracking hashed passwords</li><li>Session hijacking (to a very small extent)</li><li>XML/XPATH injection</li><li>Exploitation of client-side validation</li><li>Usage of hidden forms/weak validation</li><li>OSINT/Phishing</li></ul><p>Note: The scope was specifically the web application - shell access, if even possible, was out of scope.</p><p>The event ran for two weeks, with various hints and bonus assignments being dropped by the group running it along the way.</p><p>Overall, a pretty great package for someone who is getting into web app penetration testing like me!</p><h1 id=so-how-did-it-go>So how did it go?<a href=#so-how-did-it-go class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Well. <em>Too</em> well&mldr; Within the first few hours I&rsquo;d already dumped the entire backing database and gained admin privileges within the application.</p><p>As it turns out, the real challenge here is understanding <em>all of the vulnerabilities</em>, not just exploiting them.</p><p>Going back to the automated scoring, if you perform some basic SQLi, like an auth bypass, you&rsquo;ll probably get some points awarded for it, but what if you do something more malicious with that form like update some data or drop a table? That might also give some points&mldr; What if you do that again in a different form, or URL, etc on the site?</p><p>Effectively it was a few hours to pwn the application and database, and then another dozen or more hours of hunting down the ways the organizers <em>wanted</em> the application to be exploited. This lead to some really fun team work (which was explicitly permitted, we asked!) to do some divide and conquer on enumerating other vulnerabilities and challenges.</p><p>The other interesting thing here is that the 50+ &ldquo;flags&rdquo; <em>are not</em> enumerated from the start, so it&rsquo;s a hunt to exploit the application in any way you can, as well as trying to exploit it in ~50 different ways. You can imagine how surprised some of us were to find out that there were additional SQLi challenges that we hadn&rsquo;t found despite having already gone so far as giving ourselves infinite money and dropping the database.</p><h1 id=bonus-objectives>Bonus objectives<a href=#bonus-objectives class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>One of the really fun parts of this event is that there were also <em>completely unknown</em> bonus challenges that could be scored. Effectively, if you could find a novel way of exploiting the application (e.g. session hijacking, persistent XSS, CSRF, Phishing, etc&mldr;) you could be awarded additional points from a hidden list that the organizers had.</p><p>While this meant that there was a <em>lot</em> of time spent trying to find novel approaches to things, and submitting them to the organizers for review, it did keep things quite fresh even after completing a vast majority of the base challenges.</p><p>I will note that one area here that was frustrating is that there were a small number of bonus objectives that were only available if you reviewed <em>out of scope</em> parts of the event, and you&rsquo;d only gain knowledge of them by intercepting traffic for said out of scope website. This was quite frustrating, but fortunately didn&rsquo;t come into play for overall standings - I&rsquo;ve of course politely shared this feedback with the organizers. With that said, I found all of these since they could be identified passively - no need to attack anything out of scope, just look closely at the traffic you receive when loading it.</p><p>N.B. There&rsquo;s a fun easter egg if you try to get a web shell via arbitrary file upload ;)</p><h1 id=final-standings>Final standings<a href=#final-standings class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Out of ~140 folks who entered and completed at least some challenges, I landed in first place by about a 3% margin on score!</p><p>Given that this was my first &ldquo;competitive&rdquo; CTF event I&rsquo;m quite pleased, though it was certainly on the easier side compared to many of the boxes on HackTheBox/TryHackMe - at least in terms of understanding attack surface and getting a foothold/privilege escalation.</p><p>If any folks reading this have the opportunity to participate in one of the ShadowBank/Contoso Financial CTF events I&rsquo;d <em>highly</em> encourage it - especially if you&rsquo;re newer to &ldquo;hacking&rdquo;.</p><p>Now to wait for the prize swag to arrive. GG!</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://www.maclaren.dev/tags/ctf>ctf</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>830 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-04-19 00:00 +0000</p></footer></article><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents></nav></aside><div class="post-nav thin"><a class=next-post href=https://www.maclaren.dev/posts/2022-05/htb_cyber_apolcalypse/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>HackTheBox - Cyber Apocalypse 2022</span></a>
<a class=prev-post href=https://www.maclaren.dev/posts/2022-04/htb_pandora/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Hack The Box - Pandora</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2022 <a href=https://www.maclaren.dev>Logan MacLaren</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a> &#183; <a rel=me href=https://infosec.exchange/@gill3tt3>Mastodon</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://www.maclaren.dev/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://www.maclaren.dev/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin=anonymous></script></body></html>