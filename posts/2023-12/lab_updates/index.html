<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="State of the Lab (late 2023)"><meta itemprop=description content="Didn&rsquo;t you just blog that this was going to be a 2024 project? Or, more specifically, I got a bit too excited after writing the last post and some hardware I was eyeing up went on sale. Since this update is happening today (hopefully) I figured this might be a good time to finally do a full walkthrough of what hardware and services I&rsquo;m running.
The hardware Old & busted As noted, I&rsquo;m finally replacing my venerable home server."><meta itemprop=datePublished content="2023-12-23T00:00:00+00:00"><meta itemprop=dateModified content="2023-12-23T00:00:00+00:00"><meta itemprop=wordCount content="2460"><meta itemprop=keywords content="homelab,linux,"><meta property="og:title" content="State of the Lab (late 2023)"><meta property="og:description" content="Didn&rsquo;t you just blog that this was going to be a 2024 project? Or, more specifically, I got a bit too excited after writing the last post and some hardware I was eyeing up went on sale. Since this update is happening today (hopefully) I figured this might be a good time to finally do a full walkthrough of what hardware and services I&rsquo;m running.
The hardware Old & busted As noted, I&rsquo;m finally replacing my venerable home server."><meta property="og:type" content="article"><meta property="og:url" content="https://www.maclaren.dev/posts/2023-12/lab_updates/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-23T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="State of the Lab (late 2023)"><meta name=twitter:description content="Didn&rsquo;t you just blog that this was going to be a 2024 project? Or, more specifically, I got a bit too excited after writing the last post and some hardware I was eyeing up went on sale. Since this update is happening today (hopefully) I figured this might be a good time to finally do a full walkthrough of what hardware and services I&rsquo;m running.
The hardware Old & busted As noted, I&rsquo;m finally replacing my venerable home server."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>State of the Lab (late 2023)</title><link rel=stylesheet href=https://www.maclaren.dev/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://www.maclaren.dev>Logan MacLaren</a></div><nav class="site-nav hide-in-mobile"><a href=https://www.maclaren.dev/posts/>Blog</a></nav></div><div class="hdr-right hdr-icons"><button id=toc-btn class="hdr-btn desktop-only-ib" title="Table of Contents"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3" y2="6"/><line x1="3" y1="12" x2="3" y2="12"/><line x1="3" y1="18" x2="3" y2="18"/></svg></button><span class="hdr-social hide-in-mobile"><a href=https://www.linkedin.com/in/loganmaclaren/ target=_blank rel="noopener me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://github.com/maclarel target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://infosec.exchange/@gill3tt3 target=_blank rel="noopener me" title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="feather feather-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://www.maclaren.dev/posts/>Blog</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>Dec 23, 2023</span></div><h1>State of the Lab (late 2023)</h1></header><div class=content><h1 id=didnt-you-just-blog-that-this-was-going-to-be-a-2024-project>Didn&rsquo;t you just blog that this was going to be a 2024 project?<a href=#didnt-you-just-blog-that-this-was-going-to-be-a-2024-project class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p><img src=https://c.tenor.com/lZkfdEToSHEAAAAC/tenor.gif alt></p><p>Or, more specifically, I got a bit too excited after writing the last post and some hardware I was eyeing up went on sale. Since this update is happening <em>today</em> (hopefully) I figured this might be a good time to finally do a full walkthrough of what hardware and services I&rsquo;m running.</p><h1 id=the-hardware>The hardware<a href=#the-hardware class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><h2 id=old--busted>Old & busted<a href=#old--busted class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>As noted, I&rsquo;m finally replacing my venerable home server. The current (former) &ldquo;server&rdquo; is an i7 4770k with 32GB of RAM, a 256GB SATA SSD, a 1TB SATA SSD, and a RAID-1 array of 1TB spinning rust. It is old, but it has worked remarkably well over the past few years. With that noted, as I venture more into the security research space and my desire to host more services at home grows, the core count and 32GB limit of the platform has started to become a limiting factor. This machine is still extremely capable, and will probably turn into an emulation box/HTPC in its next life, albeit with the RAID array removed.</p><h2 id=new-hotness>New hotness<a href=#new-hotness class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>The new &ldquo;server&rdquo; is a Beelink SER5 with a Ryzen 5800H, 64GB RAM, a 500GB NVMe drive, and I&rsquo;ll be porting over the 1TB SSD from the previous build. This build nearly doubles the per-thread performance compared to the 4770k, while doubling the core/thread count, and doubling the RAM. A larger SSD may be needed in the long run, but the current 1TB will only be about half utilized with my current needs.</p><h2 id=the-complete-hardware-stack>The complete hardware stack<a href=#the-complete-hardware-stack class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><ul><li>Beelink SER5 mini-PC</li><li>Synology DS918 NAS</li><li>CyberPower CP1500AVRLCD UPS</li></ul><p>Yep, that&rsquo;s it. I had considered getting several of the Beelink boxes to run Proxmox in an HA or cluster configuration, but I simply don&rsquo;t have the need nor do I want the additional headache and cost of running a separate storage plane.</p><p>The UPS is nothing special. Even with the current power draw, this can power my entire stack for about 30 minutes. With the existing server shut down that extends to nearly an hour, and I expect it to land around the 45 minute mark after the Beelink box is up and running to replace the power-hog that is the current i7-based server.</p><h2 id=the-network-stack>The network stack<a href=#the-network-stack class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>This is where there&rsquo;s a bit more going on. Across my home, which is by no means large, I have an assortment of smart devices (Fire TVs, Chromecasts, etc), a few dozen IoT devices (cameras, outlets, etc), 5 actively used compupters, and a plethora of other devices. As I also work from home, network reliability is very important to me, as is the ability to segregate traffic on my network.</p><h3 id=network-hardware>Network hardware<a href=#network-hardware class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><ul><li>UniFi Dream Machine</li><li>DLink 24-port unmanaged Gigabit switch</li><li>DLink 5-port unmanaged Gigabit switch</li><li>TP-Link 5-port unmanaged Gigabit PoE switch</li><li>2x UniFi U6 Pro APs</li><li>1x UniFi Nano-AC AP</li><li>1x UniFi AC Mesh AP</li><li>goCoax MoCA 2.5 Adapter</li></ul><p>The AC Mesh AP services my backyard since it is outdoor rated, and the other APs are spread through the garage (Nano AC) and floors (U6 Pros) of my house. Overall this means that I&rsquo;ve got pretty much &ldquo;full speed&rdquo; WiFi coverage anywhere on my (quite small) property. I went with Ubiquiti UniFi gear for most of this due to the simplicity of setting it up and, in my experience, the relatively reliability of it without the management overhead of something like MikroTik.</p><p>The switches in the network are all &ldquo;dumb&rdquo;. While I do plan to upgrade the main 24-port switch that acts as backhaul for everything over to a UniFi PoE switch this year, I have limited need for network segregation on the physical level. I maintain &ldquo;Prod&rdquo;, IOT, and guest networks on my LAN, however IOT and Guest networks are WiFi only at this time. While I&rsquo;d love to have some more wired opportunities, my house lacks cabling to support it, and this is partially where the MoCA adapter has come in.</p><p>Since I don&rsquo;t have in-wall ethernet wiring, and realistically I don&rsquo;t see the value in tearing open my walls to add it, I&rsquo;ve opted to handle my network backhaul between floors over coax. I was a bit reluctant to do this initially, hearing concerns about the added latency, single duplex nature, etc&mldr; however in practice this hasn&rsquo;t been an issue. Yes, there&rsquo;s an added 2-3ms of latency, but I&rsquo;m unable to saturate the link this gives me and I don&rsquo;t foresee a usecase where I need > 2.5GbE between floors for quite a while. This will come eventually, but isn&rsquo;t a priority right now.</p><p>Near-term I&rsquo;ll <em>likely</em> be picking up a UniFi 16 port Gigabit switch, an unmanaged 8 port PoE switch, and likely another 5 port unmanaged DLink switch. The TP-Link switch I bought is unfortunately faulty, with only 3 working ports, so I&rsquo;m hoping to replace that and remove my need for PoE injectors entirely. These will probably be spring/summer upgrades, and something I need to be cost-conscious on.</p><h1 id=the-software>The software<a href=#the-software class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Obviously the network software goes without saying, so I&rsquo;m going to focus on detailing the services I&rsquo;m running on my Server & NAS, and why I&rsquo;ve chosen them.</p><p>To start off with, I run virtually everything in Docker containers. I wrote about this <a href=https://www.maclaren.dev/posts/2021-11/home_lab_updates/#so-what-am-i-doing-with-all-these-toys>back in 2021</a> but the reduced management requirement & significantly reduced resource utilization of running services in containers over individual VMs has been a god-send in terms of making the most of my hardware. With this noted, I do run a number of VMs, and in fact these were a driving force behind the in-progress server replacement.</p><h2 id=vms>VMs<a href=#vms class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>As noted, I do run several VMs, and one notable change with the rebuild is that I&rsquo;ll be virtualizing my current server in its entirety since I&rsquo;ll be running Proxmox on the new host:</p><ul><li>Containers (Ubuntu Server)</li><li>Ansible (Ubuntu Server)</li><li>3 Linux sandbox VMs (Ubuntu Server)</li><li>Kali (Debian-based)</li><li>Windows 10</li><li>Windows 11</li></ul><p>Breaking these down a little further, let&rsquo;s talk about the uses cases.</p><h3 id=ubuntu-server>Ubuntu Server<a href=#ubuntu-server class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>While I&rsquo;m not the biggest fan of Cannonical&rsquo;s decisions or ways they do business, there&rsquo;s something to be said for having a homogenous setup internally, and in my expericen Ubuntu comes with fewer (or perhaps, different) headaches compared to running straight Debian. This also simplifies my update processes since all of my managed Linux endpoints are using <code>apt</code> for package management.</p><h3 id=container-vm>Container VM<a href=#container-vm class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>This is effectively virtualizing my existing server. Since Proxmox will handle the hypervisor layer for me, I don&rsquo;t really want to also run my containers on bare metal if I don&rsquo;t need to. This will be home to many services running in Docker (eventually Podman, maybe) and ideally little to nothing else.</p><h3 id=ansible-vm>Ansible VM<a href=#ansible-vm class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>I use Ansible to enforce various configurations across my servers as well as to manage updates, TLS certificate renewal, and some backups. Right now this is managing all of my VMs, but may be expanded out to my physical nodes in the future.</p><p>Reasonably typical usecase here, and I like having this on its own VM for logical segregation, though I wish Ansible didn&rsquo;t require unfettered root access (via <code>become</code> to operate). I maintain all of my playbooks <a href=https://github.com/maclarel/ansible_playbooks>on GitHub</a> for ease of version control and development.</p><h3 id=sandbox-vms>Sandbox VMs<a href=#sandbox-vms class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>These don&rsquo;t have dedicated use right now, and are mostly for tinkering with my Ansible playbooks. Now that I have more robust hardware, these may end up as a layer to experiment with K3s, however it&rsquo;s more likely that these will host whatever services I am poking at for vulnerability research since I don&rsquo;t necessarily want those running on &ldquo;prod&rdquo; hosts.</p><h3 id=kali-vm>Kali VM<a href=#kali-vm class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>I work in the security space and Kali is a great tool. While the packages it comes with can be installed pretty much anywhere, and I have most on my other machines, I&rsquo;ve found having the VM to be exceptionally useful. I do not leave my main PC powered on, and my laptop is a work-managed endpoint, so having a machine dedicated to tooling that would otherwise set off work-related alarm bells is extremely helpful when I&rsquo;m on the road or otherwise don&rsquo;t want to physically leave my work setup.</p><h3 id=windows-vms>Windows VMs<a href=#windows-vms class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>I need these for work as well as vulnerability testing. In short, I work with a lot of client-side applications, so these are important testbeds for me despite not using Windows personally or professionally in any other capacity.</p><h2 id=containers>Containers<a href=#containers class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><h3 id=ddclienthttpsdocslinuxserverioimagesdocker-ddclient><a href=https://docs.linuxserver.io/images/docker-ddclient/>ddclient</a><a href=#ddclienthttpsdocslinuxserverioimagesdocker-ddclient class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p><code>ddclient</code> handles Dynamic DNS for me, updating a record under my domain that allows me to remote back in to my home network via Wireguard without the need (or ability) to have a static IP from my ISP.</p><h3 id=wyze-bridgehttpsgithubcommrlt8docker-wyze-bridge><a href=https://github.com/mrlt8/docker-wyze-bridge>Wyze Bridge</a><a href=#wyze-bridgehttpsgithubcommrlt8docker-wyze-bridge class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>I use Wyze &ldquo;security&rdquo; cameras around my property. Like the rest of the IoT devices, these live on their own network, and similarly are only outdoor-facing to minimize exposure for when Wyze repeats the same mistakes that seem to plague all camera vendors and share my cameras to someone else.</p><p>The Wyze Bridge service integrates with the Wyze API and transforms the camera streams into RTSP. While Wyze does offer some form of RTSP firmware, it&rsquo;s not supported, and it has several caveats. This keeps my exiting functionality fully intact, while also giving me easy local access to my camera feeds in a browser or when integrated through another service.</p><p>I&rsquo;d like to pull these feeds into Frigate at some point, however I&rsquo;ve had some massive performance problems with Frigate in the past, and also having <a href=https://github.blog/2023-12-13-securing-our-home-labs-frigate-code-review/>some significant concerns with its security model</a>.</p><h3 id=homepagehttpsgithubcomgethomepagehomepage><a href=https://github.com/gethomepage/homepage>Homepage</a><a href=#homepagehttpsgithubcomgethomepagehomepage class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Homepage does what it says on the tin. I use this as a landing page for everything I run internally. A one-stop shop for all the links I need, weather, and search. The default location for all of my new browser tabs.</p><h3 id=jellyfinhttpsjellyfinorg><a href=https://jellyfin.org/>Jellyfin</a><a href=#jellyfinhttpsjellyfinorg class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>An open source Plex replacement, Jellyfin allows me to stream my thousands of hours of &ldquo;Linux ISOs&rdquo; to my client devices. Great for audio and video, no complaints!</p><h3 id=joplinhttpsgithubcomlaurent22joplin><a href=https://github.com/laurent22/joplin>Joplin</a><a href=#joplinhttpsgithubcomlaurent22joplin class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Joplin is a note taking app that supports Markdown and gives me the ability to store all of my data locally on my network, encrypted at rest and in transit, and still support syncing with all of my mobile devices as long as they have network connectivity to the server (via VPN or otherwise). While it&rsquo;s not as powerful as something like Notion, the ability to encrypt and store all of my notes locally is very important to me since this is also used for work purposes.</p><h3 id=mealiehttpsgithubcommealie-recipesmealie><a href=https://github.com/mealie-recipes/mealie>Mealie</a><a href=#mealiehttpsgithubcommealie-recipesmealie class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Mealie is a new addition to my list of services, but in short its a cookbook where I can either scrape websites for recipe information or I can enter it myself. Very useful as I experiment with different techniques when cooking barbeque!</p><h3 id=nginxhttpsnginxorgen><a href=https://nginx.org/en/>Nginx</a><a href=#nginxhttpsnginxorgen class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>This doesn&rsquo;t need any introduction to the audience reading this blog, but in short I use Nginx as both a web server and reverse proxy to give me a TLS front-end for all of my containers.</p><p>To that end, virtually all of my services do not offer (or at least not trivially) out-of-the-box support for TLS, so proxying access is quite important. To accomplish this, most of my containers have their network ports only exposed to <code>127.0.0.1</code> and I then &ldquo;publicly&rdquo; (to my network) expose those as TLS-enabled endpoints through Nginx.</p><p>I&rsquo;m aware that Nginx Proxy Manager exists, however I also use Nginx professionally so I see great value in digging into all of this manually and in some cases <a href=https://github.com/mrlt8/docker-wyze-bridge/issues/989#issuecomment-1763431176>this greatly simplifies troubleshooting</a>.</p><h3 id=piholehttpspi-holenet><a href=https://pi-hole.net/>PiHole</a><a href=#piholehttpspi-holenet class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>This is my ad-blocker of choice for my network, and also handles local DNS records (managed through Ansible as well). I also run this in a container on my Synology NAS so that I&rsquo;ve got failover in the event that either host goes down.</p><h3 id=portainerhttpswwwportainerio><a href=https://www.portainer.io/>Portainer</a><a href=#portainerhttpswwwportainerio class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>This one is an experiment. On paper, Portainer gives me a level of management for my Docker Compose stacks, however I&rsquo;ve found that with the free version there are many limitations on things that are otherwise trivial for me to do via SSH or through Ansible (e.g. updating all stacks to pull the latest images). Not sure if this will stick around, but we will see!</p><h3 id=qbittorrent--wireguard>QBittorrent & Wireguard<a href=#qbittorrent--wireguard class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>This is a bespoke setup where I&rsquo;m running <a href=https://github.com/linuxserver/docker-qbittorrent>QBitTorrent</a> with its networking routed through a Wireguard container connecting to my VPN of choice. No one needs to know that I secretly download SUSE Linux ISOs&mldr;</p><h3 id=searxnghttpsgithubcomsearxngsearxng><a href=https://github.com/searxng/searxng>SearXNG</a><a href=#searxnghttpsgithubcomsearxngsearxng class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>SearX (or SearXNG in this case) is an anonymized search aggregator. In short, this gives me results from my search engines of choice, but performs those searches in a form that can&rsquo;t be tied back to an individual (beyond an IP address) and as such helps get rid of a significant amount of tracking, ad personalization, etc.</p><p>The quality of results, unfortunately, does suffer from this but I find the privacy tradeoffs to be conceptually worthwhile.</p><h3 id=wireguardhttpsgithubcomlinuxserverdocker-wireguard><a href=https://github.com/linuxserver/docker-wireguard>Wireguard</a><a href=#wireguardhttpsgithubcomlinuxserverdocker-wireguard class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>And last, but absolutely not least, I run Wireguard in a container. This is mostly <a href=https://www.maclaren.dev/posts/2022-09/bell_udm/#wireguard>to deal with some bizarre limitations with how Ubiquiti implements their own VPN solutions</a>, but it&rsquo;s aslo nice knowing that I&rsquo;ve got more complete control over how it all works.</p><p>Unlike UniFi software, I also don&rsquo;t mind publicly exposing Wireguard as an endpoint.</p><h1 id=whats-next>What&rsquo;s next?<a href=#whats-next class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Whew, that&rsquo;s a lot of writing, but that&rsquo;s the current state of my lab & network. At the end of the day, PiHole is the only thing here that really does a &ldquo;mission critical&rdquo; job for me, with Wireguard coming in as a close second. The others exist for convenience, and frankly have also made for really fun targets to do security research with and I&rsquo;ve been in touch with some maintainers to get bugs addressed&mldr; Let the CVEs flow!</p><p>Next up will be the network upgrades I had referenced, hopefully bringing me to my &ldquo;endgame&rdquo; state as it exists for the next few years until 10GbE reaches a more affordable point. Some other thoughts, permitted by the additional hardware, would be to set up an Active Directory host and manage the Windows VMs there to facilitate some learning in that space since it&rsquo;s clearly extremely hot in the security world.</p><p>Lastly, a workflow shift on my side is that I use my existing bare-metal server for a fair bit of experimentation work when I need to run Linux (or x86 in general) workloads and I&rsquo;m stuck working on my Apple Silicon Mac. While I&rsquo;ve got the sandbox VMs, these see a lot of churn and aren&rsquo;t something that I want to exist outside of a &ldquo;lab&rdquo; capacity - same deal with the Kali VM. I may wind up creating a &ldquo;development&rdquo; VM where I&rsquo;ve got all of the dev tools that I need in a one-stop-shop that I can hit on my local network or over VPN.</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://www.maclaren.dev/tags/homelab>homelab</a></span><span class=tag><a href=https://www.maclaren.dev/tags/linux>linux</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>2460 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-12-23 00:00 +0000</p></footer></article><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents><ul><li><a href=#old--busted>Old & busted</a></li><li><a href=#new-hotness>New hotness</a></li><li><a href=#the-complete-hardware-stack>The complete hardware stack</a></li><li><a href=#the-network-stack>The network stack</a><ul><li><a href=#network-hardware>Network hardware</a></li></ul></li></ul><ul><li><a href=#vms>VMs</a><ul><li><a href=#ubuntu-server>Ubuntu Server</a></li><li><a href=#container-vm>Container VM</a></li><li><a href=#ansible-vm>Ansible VM</a></li><li><a href=#sandbox-vms>Sandbox VMs</a></li><li><a href=#kali-vm>Kali VM</a></li><li><a href=#windows-vms>Windows VMs</a></li></ul></li><li><a href=#containers>Containers</a><ul><li><a href=#ddclienthttpsdocslinuxserverioimagesdocker-ddclient><a href=https://docs.linuxserver.io/images/docker-ddclient/>ddclient</a></a></li><li><a href=#wyze-bridgehttpsgithubcommrlt8docker-wyze-bridge><a href=https://github.com/mrlt8/docker-wyze-bridge>Wyze Bridge</a></a></li><li><a href=#homepagehttpsgithubcomgethomepagehomepage><a href=https://github.com/gethomepage/homepage>Homepage</a></a></li><li><a href=#jellyfinhttpsjellyfinorg><a href=https://jellyfin.org/>Jellyfin</a></a></li><li><a href=#joplinhttpsgithubcomlaurent22joplin><a href=https://github.com/laurent22/joplin>Joplin</a></a></li><li><a href=#mealiehttpsgithubcommealie-recipesmealie><a href=https://github.com/mealie-recipes/mealie>Mealie</a></a></li><li><a href=#nginxhttpsnginxorgen><a href=https://nginx.org/en/>Nginx</a></a></li><li><a href=#piholehttpspi-holenet><a href=https://pi-hole.net/>PiHole</a></a></li><li><a href=#portainerhttpswwwportainerio><a href=https://www.portainer.io/>Portainer</a></a></li><li><a href=#qbittorrent--wireguard>QBittorrent & Wireguard</a></li><li><a href=#searxnghttpsgithubcomsearxngsearxng><a href=https://github.com/searxng/searxng>SearXNG</a></a></li><li><a href=#wireguardhttpsgithubcomlinuxserverdocker-wireguard><a href=https://github.com/linuxserver/docker-wireguard>Wireguard</a></a></li></ul></li></ul></nav></aside><div class="post-nav thin"><a class=prev-post href=https://www.maclaren.dev/posts/2023-12/2023/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>2023 in Review - DEFCON, CVEs, and Life</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2023 <a href=https://www.maclaren.dev>Logan MacLaren</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a> &#183; <a rel=me href=https://infosec.exchange/@gill3tt3>Mastodon</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://www.maclaren.dev/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://www.maclaren.dev/js/bundle.min.7d8545daa55d62427355498dd8da13f98ff79a7938ce7d2a5e2ae1ec0de3beb8.js integrity="sha256-fYVF2qVdYkJzVUmN2NoT+Y/3mnk4zn0qXirh7A3jvrg=" crossorigin=anonymous></script></body></html>